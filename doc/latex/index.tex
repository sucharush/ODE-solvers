Project for M\+A\+T\+H-\/458 Programming concepts in scientific computing (E\+P\+FL, 2024). \hypertarget{index_autotoc_md1}{}\doxysection{Team members}\label{index_autotoc_md1}

\begin{DoxyItemize}
\item Ezra Baup, \href{mailto:estelle.baup@epfl.ch}{\texttt{ estelle.\+baup@epfl.\+ch}}
\item Siyuan Cheng, \href{mailto:siyuan.cheng@epfl.ch}{\texttt{ siyuan.\+cheng@epfl.\+ch}}
\end{DoxyItemize}\hypertarget{index_autotoc_md2}{}\doxysection{Table of contents}\label{index_autotoc_md2}

\begin{DoxyItemize}
\item \href{\#project-overview}{\texttt{ Project Overview}}
\item \href{\#how-to}{\texttt{ How to}}
\item \href{\#features}{\texttt{ Features}}
\item \href{\#limitations}{\texttt{ Limitations}}
\end{DoxyItemize}\hypertarget{index_autotoc_md3}{}\doxysection{Disclaimer for latex}\label{index_autotoc_md3}
The latex configuration is not entirely set for the Doxygen page, please use the preview on your editor or the preview from the Gitlab website to read the formulas easier.\hypertarget{index_autotoc_md4}{}\doxysection{Project Overview}\label{index_autotoc_md4}
This project provides an implementation of numerical solvers for solving ordinary differential equations (O\+D\+Es), i.\+e. \$y$^\wedge$\{\textquotesingle{}\}(t)=f(t,y(t))\$. The solvers currently support the following methods\+:


\begin{DoxyItemize}
\item {\bfseries{Forward Euler (FE)}}\+: Explicit single-\/step solver.
\item {\bfseries{Runge-\/\+Kutta (RK)}}\+: Explicit single-\/step solver supporting orders 1 through 4.
\item {\bfseries{Adams-\/\+Bashforth (AB)}}\+: Explict multistep solver with configurable order and initialization method (e.\+g., R\+K4, Forward Euler).
\item {\bfseries{Backward Euler (BE)}}\+: Implicit single-\/step solver with optional tolerance and iteration settings.
\end{DoxyItemize}

The default implementation solves the model problem \$y$^\wedge$\{\textquotesingle{}\} = -\/0.\+3y\$ using a 4th-\/order Runge-\/\+Kutta method. The project is modular, allowing customization of solvers, functions, and configurations. \hypertarget{index_autotoc_md5}{}\doxysubsection{Right-\/\+Hand Side (\+R\+H\+S) Functions}\label{index_autotoc_md5}
To represent the right-\/hand side function \$f(t, y)\$ in the O\+DE, the project provides the following built-\/in options\+:


\begin{DoxyEnumerate}
\item $\ast$$\ast$\+Model Problem ({\ttfamily model})$\ast$$\ast$\+:
\begin{DoxyItemize}
\item Describes a simple exponential decay problem \$f(t, y) = -\/k \textbackslash{}cdot y\$.
\item Requires a positive decay constant {\ttfamily decay = k}.
\item Given the initial condition \$y(t) = y\+\_\+0\$, the analytical solution is \$y(t) = y\+\_\+0 e$^\wedge$\{-\/k(t-\/t\+\_\+0)\}.\$
\end{DoxyItemize}
\item $\ast$$\ast$\+Polynomial Function ({\ttfamily poly})$\ast$$\ast$\+:
\begin{DoxyItemize}
\item Describes a polynomial of the form \$f(t, y) = a\+\_\+0 + a\+\_\+1 y + a\+\_\+2 y$^\wedge$2 + \textbackslash{}dots + a\+\_\+n y$^\wedge$n\$.
\item Requires a list of coefficients {\ttfamily \mbox{[}a\+\_\+0, a\+\_\+1, ..., a\+\_\+n\mbox{]}}.
\end{DoxyItemize}
\end{DoxyEnumerate}

These R\+HS functions can be selected and configured in the configuration file ({\ttfamily config/config.\+json}), providing flexibility for different types of O\+D\+Es. You can also implement custom R\+HS functions by modifying the {\ttfamily Example\+R\+HS} classes.\hypertarget{index_autotoc_md6}{}\doxysection{Structure}\label{index_autotoc_md6}
The main structure of the project is as follows\+:
\begin{DoxyItemize}
\item {\ttfamily /config}\+: configuration settings to run the main.
\item {\ttfamily /include}\+: contains all header files.
\item {\ttfamily /src}\+: contains all implementation files.
\item {\ttfamily /test}\+: contains test files, supported by googletest.
\end{DoxyItemize}


\begin{DoxyCode}{0}
\DoxyCodeLine{pcsc-\/project/}
\DoxyCodeLine{├── config/}
\DoxyCodeLine{│   └── config.json                               // Configuration settings}
\DoxyCodeLine{├── include/}
\DoxyCodeLine{│   ├── AbstractOdeSolver.h                       // Base class for all solvers}
\DoxyCodeLine{│   ├── AdamsBashforthSolver.h                    }
\DoxyCodeLine{│   ├── BackwardEulerSolver.h                    }
\DoxyCodeLine{│   ├── ButcherTableau.h                          // For Runge-\/Kutta}
\DoxyCodeLine{│   ├── ConfigParser.h                           }
\DoxyCodeLine{│   ├── ExampleRHS.h                              }
\DoxyCodeLine{│   ├── ExplicitMultiStepSolver.h                 // Extends ExplicitSolver to multi-\/step}
\DoxyCodeLine{│   ├── ExplicitSingleStepSolver.h                // Extends ExplicitSolver to single-\/step}
\DoxyCodeLine{│   ├── ExplicitSolver.h                          // Base class for all explicit solvers}
\DoxyCodeLine{│   ├── ForwardEulerSolver.h                    }
\DoxyCodeLine{│   ├── ImplicitSolver.h                          // Base class for implicit solvers}
\DoxyCodeLine{│   ├── json.hpp                      }
\DoxyCodeLine{│   ├── KnownDerivativeRHS.h                      // RHS with analytically known derivative}
\DoxyCodeLine{│   ├── ModelProblemRHS.h}
\DoxyCodeLine{│   ├── ODERightHandSide.h                        // Base class for RHS functions}
\DoxyCodeLine{│   ├── PolynomialRHS.h}
\DoxyCodeLine{│   ├── RungeKuttaSolver.h                       }
\DoxyCodeLine{│   ├── SolverFactory.h                           }
\DoxyCodeLine{│   └── UnknownDerivativeRHS.h                    // RHS with unknown derivative }
\DoxyCodeLine{├── src/}
\DoxyCodeLine{│   └── [Corresponding .cc files implementing the headers]}
\DoxyCodeLine{├── test/}
\DoxyCodeLine{│   └── [Test files using googletest]}
\DoxyCodeLine{├── .gitignore}
\DoxyCodeLine{├── .gitmodules}
\DoxyCodeLine{├── main.cc     }
\DoxyCodeLine{├── CMakeLists.txt                                }
\DoxyCodeLine{└── README.md                          }
\end{DoxyCode}


Here is a brief sketch of the class hierarchy.

\hypertarget{index_autotoc_md7}{}\doxysection{How to}\label{index_autotoc_md7}
\hypertarget{index_autotoc_md8}{}\doxysubsection{Quick Start}\label{index_autotoc_md8}
First, you need to clone the project repository on your local machine. 
\begin{DoxyCode}{0}
\DoxyCodeLine{git clone git@gitlab.epfl.ch:ebaup/pcsc-\/project.git}
\DoxyCodeLine{cd pcsc-\/project}
\end{DoxyCode}
\hypertarget{index_autotoc_md9}{}\doxysubsection{Set-\/up and Building}\label{index_autotoc_md9}
The project relies on {\itshape googletest} and {\itshape Eigen}, initialize them as submodules to install these dependencies\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{git submodule update -\/-\/init }
\end{DoxyCode}


You can build and run the project using your preferred I\+DE (e.\+g., C\+Lion) or the terminal. Below are the steps for the terminal\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{mkdir build}
\DoxyCodeLine{cd build}
\DoxyCodeLine{cmake ..}
\DoxyCodeLine{make}
\DoxyCodeLine{./main}
\end{DoxyCode}
\hypertarget{index_autotoc_md10}{}\doxysubsection{Read the output file}\label{index_autotoc_md10}

\begin{DoxyCode}{0}
\DoxyCodeLine{cat output.txt}
\end{DoxyCode}
\hypertarget{index_autotoc_md11}{}\doxysubsection{Update the Configuration}\label{index_autotoc_md11}
Modify the {\ttfamily config/config.\+json} file to set global parameters and solver-\/specific options. 
\begin{DoxyCode}{0}
\DoxyCodeLine{\{}
\DoxyCodeLine{  "global": \{}
\DoxyCodeLine{    "stepSize": The time step for the solver, e.g., 0.01,}
\DoxyCodeLine{    "t0": Start time of the simulation, e.g., 0.0,}
\DoxyCodeLine{    "t1": End time of the simulation, e.g., 1.0,}
\DoxyCodeLine{    "initialValue": Initial guess y\_0, e.g., 1.0}
\DoxyCodeLine{  \},}
\DoxyCodeLine{  "solver": \{}
\DoxyCodeLine{    "method": Solver type, choose from \{"RK", "AB", "BE", "FE"\},}
\DoxyCodeLine{    "parameters": \{}
\DoxyCodeLine{      "order": For Runge Kutta, choose from \{1, 2, 4\},}
\DoxyCodeLine{      "steps": For AdamsBashforth, choose from \{1, 2, 3, 4\},}
\DoxyCodeLine{      "initMethod": For AdamsBashforth, choose from \{"RK4", "FE"\},}
\DoxyCodeLine{      "tolerance": For Newton method in Backward Euler, default 1e-\/6,}
\DoxyCodeLine{      "maxIter": For Newton method in Backward Euler, default 50}
\DoxyCodeLine{    \}}
\DoxyCodeLine{  \},}
\DoxyCodeLine{  "rhs": \{}
\DoxyCodeLine{    "type": RHS type, choose from \{"model", "poly"\},}
\DoxyCodeLine{    "parameters": \{}
\DoxyCodeLine{      "decay": Decay constant for model problem, e.g., 0.1,}
\DoxyCodeLine{      "coefficients": For polynomials, a list of coefficients [a\_0, a\_1, ..., a\_n]}
\DoxyCodeLine{    \}}
\DoxyCodeLine{  \}}
\DoxyCodeLine{\}}
\end{DoxyCode}


{\bfseries{Note\+:}} It will automatically build the forward Euler method when choosing {\ttfamily order = 1} for Runge Kutta or {\ttfamily steps = 1} for Adams\+Bashforth, as they are the same solvers.\hypertarget{index_autotoc_md12}{}\doxysubsection{Documentation}\label{index_autotoc_md12}
Building the project also creates a folder \textquotesingle{}doc\textquotesingle{}, that contains the doxygen documentation of the project. To see this documentation, there are a few alternatives\+:
\begin{DoxyItemize}
\item open the file \textquotesingle{}index.\+html\textquotesingle{} located in doc/html/. This should open a window in your browser with our documentation.
\item use doxywizard (type {\ttfamily doxywizard} in your terminal) and select the Doxyfile located in the main folder of the project. Then you can run doxygen from doxywizard to generate the documentation.
\end{DoxyItemize}\hypertarget{index_autotoc_md13}{}\doxysubsection{Tests}\label{index_autotoc_md13}
Another executive file produced by the building concerns the googletests. They are separated in 3 files\+:
\begin{DoxyItemize}
\item {\ttfamily auxiliary\+\_\+test.\+cc}\+: contains tests on auxiliary classes, mainly on the function class.
\item {\ttfamily model\+\_\+problem\+\_\+test.\+cc}\+: contains tests focusing on the model problem. In each execution of this test, a random variable between 0 and 1 is produced, and then all solvers are tested on the model problem defined by this variable.
\item {\ttfamily polynomial\+\_\+test.\+cc}\+: contains tests on a specific polynomial function, for all solvers.
\end{DoxyItemize}

All tests that consist of testing the solvers rely on testing the difference between the actual solution and the approximated one. The tests should pass, also the tolerance threshold for the error is quite high (1e-\/2). Note that some solvers are also more or less precise, and may require a smaller step size.\hypertarget{index_autotoc_md14}{}\doxysection{Limitations}\label{index_autotoc_md14}
We encountered various challenges during the realisation of this project, some were taken care of, and some remain as limitations of our implementation.\hypertarget{index_autotoc_md15}{}\doxysubsection{Solvers classes}\label{index_autotoc_md15}
Our first main challenge was to find a suitable class organisation for the different solvers.

A good knowledge of the methods was needed to understand how they relate with each other, and what were their common and specific characteristics. There are different approaches we thought about, and we decided to split the methods between two main categories\+: {\bfseries{explicit}} and {\bfseries{implicit}}. The explicit methods can be single-\/step or multi-\/step methods.

Another approach we thought about was to separate in two other categories\+: Runge-\/\+Kutta and linear multi-\/step methods. Then linear multi-\/step methods could have been split between explicit and implicit and would have been determined by their weights.\hypertarget{index_autotoc_md16}{}\doxysubsection{Function classes}\label{index_autotoc_md16}
Our second main challenge was to create a function class, and handle the derivatives. We decided to create a base class ({\ttfamily O\+D\+E\+Righ\+Hand\+Side}) and two child classes that correspond to functions for which we know the derivative and for which we do not. If the derivative is unknown, it is approximated using centered differences.

There are however a few limitations with our approach.
\begin{DoxyItemize}
\item We only provided 2 types of built-\/in functions\+: {\ttfamily \mbox{\hyperlink{class_model_problem_r_h_s}{Model\+Problem\+R\+HS}}} and {\ttfamily \mbox{\hyperlink{class_polynomial_r_h_s}{Polynomial\+R\+HS}}}.
\item Despite the possibility of using arbitrary functions in {\ttfamily \mbox{\hyperlink{class_user_defined_r_h_s}{User\+Defined\+R\+HS}}}, we didn\textquotesingle{}t manage to implement it in a way that allows the user to avoid recompilation. Additionally, the user needs to specify whether they want to use a known or unknown derivative for the function.
\end{DoxyItemize}\hypertarget{index_autotoc_md17}{}\doxysubsection{Dimension of the O\+DE}\label{index_autotoc_md17}
The main limitation of our project is that it focuses strictly on ordinary differential equations (O\+D\+Es) that map from \$\textbackslash{}mathbb\{R\} \textbackslash{}times \textbackslash{}mathbb\{R\}\$ to \$\textbackslash{}mathbb\{R\}\$. In other words, both \$y\$ and \$t\$ are real numbers, and the function \$f\$, defined by \begin{DoxyParagraph}{f}
\textbackslash{}mathbb\{R\} \textbackslash{}times \textbackslash{}mathbb\{R\} \textbackslash{}to \textbackslash{}mathbb\{R\}
\end{DoxyParagraph}
, is also real-\/valued. Possible extensions could include\+:
\begin{DoxyItemize}
\item Allowing \$y\$ to be a vector, i.\+e. \$y \textbackslash{}in \textbackslash{}mathbb\{R\}$^\wedge$n\$,
\item Enabling \$\textbackslash{}mathbf\{f\}\$ to be a vector-\/valued function, allowing it to solve systems of O\+D\+Es by defining \$\textbackslash{}mathbf\{f\}\+: \textbackslash{}mathbb\{R\} \textbackslash{}times \textbackslash{}mathbb\{R\}$^\wedge$n \textbackslash{}to \textbackslash{}mathbb\{R\}$^\wedge$n\$,
\item Extending \$y\$ to be a complex number or a complex-\/valued vector, altering the domain and range of \$f\$ to include complex dimensions.
\end{DoxyItemize}

To implement these extensions, we are considering the use of template classes and/or Eigen vectors for variable types of \$y\$. 