<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PCSC Project: Solvers for Ordinary Differential Equations: Solvers for Ordinary Differential Equations</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PCSC Project: Solvers for Ordinary Differential Equations
   </div>
   <div id="projectbrief">This project provides an implementation of numerical solvers for solving ordinary differential equations (ODEs)</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Solvers for Ordinary Differential Equations </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Project for MATH-458 Programming concepts in scientific computing (EPFL, 2024). </p>
<h1><a class="anchor" id="autotoc_md1"></a>
Team members</h1>
<ul>
<li>Ezra Baup, <a href="#" onclick="location.href='mai'+'lto:'+'est'+'el'+'le.'+'ba'+'up@'+'ep'+'fl.'+'ch'; return false;">estel<span style="display: none;">.nosp@m.</span>le.b<span style="display: none;">.nosp@m.</span>aup@e<span style="display: none;">.nosp@m.</span>pfl.<span style="display: none;">.nosp@m.</span>ch</a></li>
<li>Siyuan Cheng, <a href="#" onclick="location.href='mai'+'lto:'+'siy'+'ua'+'n.c'+'he'+'ng@'+'ep'+'fl.'+'ch'; return false;">siyua<span style="display: none;">.nosp@m.</span>n.ch<span style="display: none;">.nosp@m.</span>eng@e<span style="display: none;">.nosp@m.</span>pfl.<span style="display: none;">.nosp@m.</span>ch</a></li>
</ul>
<h1><a class="anchor" id="autotoc_md2"></a>
Table of contents</h1>
<ul>
<li><a href="#project-overview">Project Overview</a></li>
<li><a href="#how-to">How to</a></li>
<li><a href="#features">Features</a></li>
<li><a href="#limitations">Limitations</a></li>
</ul>
<h1><a class="anchor" id="autotoc_md3"></a>
Project Overview</h1>
<p>This project provides an implementation of numerical solvers for solving ordinary differential equations (ODEs), i.e. $y^{'}(t)=f(t,y(t))$. The solvers currently support the following methods:</p>
<ul>
<li><b>Forward Euler (FE)</b>: Explicit single-step solver.</li>
<li><b>Runge-Kutta (RK)</b>: Explicit single-step solver supporting orders 1 through 4.</li>
<li><b>Adams-Bashforth (AB)</b>: Explict multistep solver with configurable order and initialization method (e.g., RK4, Forward Euler).</li>
<li><b>Backward Euler (BE)</b>: Implicit single-step solver with optional tolerance and iteration settings.</li>
</ul>
<p>The default implementation solves the model problem $y^{'} = -0.3y$ using a 4th-order Runge-Kutta method. The project is modular, allowing customization of solvers, functions, and configurations. </p>
<h2><a class="anchor" id="autotoc_md4"></a>
Right-Hand Side (RHS) Functions</h2>
<p>To represent the right-hand side function $f(t, y)$ in the ODE, the project provides the following built-in options:</p>
<ol type="1">
<li>**Model Problem (<code>model</code>)**:<ul>
<li>Describes a simple exponential decay problem $f(t, y) = -k \cdot y$.</li>
<li>Requires a positive decay constant <code>decay = k</code>.</li>
<li>Given the initial condition $y(t) = y_0$, the analytical solution is $y(t) = y_0 e^{-k(t-t_0)}.$</li>
</ul>
</li>
<li>**Polynomial Function (<code>poly</code>)**:<ul>
<li>Describes a polynomial of the form $f(t, y) = a_0 + a_1 y + a_2 y^2 + \dots + a_n y^n$.</li>
<li>Requires a list of coefficients <code>[a_0, a_1, ..., a_n]</code>.</li>
</ul>
</li>
</ol>
<p>These RHS functions can be selected and configured in the configuration file (<code>config/config.json</code>), providing flexibility for different types of ODEs. You can also implement custom RHS functions by modifying the <code>ExampleRHS</code> classes.</p>
<h1><a class="anchor" id="autotoc_md5"></a>
Structure</h1>
<p>The main structure of the project is as follows:</p><ul>
<li><code>/config</code>: configuration settings to run the main.</li>
<li><code>/include</code>: contains all header files.</li>
<li><code>/src</code>: contains all implementation files.</li>
<li><code>/test</code>: contains test files, supported by googletest.</li>
</ul>
<div class="fragment"><div class="line">pcsc-project/</div>
<div class="line">├── config/</div>
<div class="line">│   └── config.json                               // Configuration settings</div>
<div class="line">├── include/</div>
<div class="line">│   ├── AbstractOdeSolver.h                       // Base class for all solvers</div>
<div class="line">│   ├── AdamsBashforthSolver.h                    </div>
<div class="line">│   ├── BackwardEulerSolver.h                    </div>
<div class="line">│   ├── ButcherTableau.h                          // For Runge-Kutta</div>
<div class="line">│   ├── ConfigParser.h                           </div>
<div class="line">│   ├── ExampleRHS.h                              </div>
<div class="line">│   ├── ExplicitMultiStepSolver.h                 // Extends ExplicitSolver to multi-step</div>
<div class="line">│   ├── ExplicitSingleStepSolver.h                // Extends ExplicitSolver to single-step</div>
<div class="line">│   ├── ExplicitSolver.h                          // Base class for all explicit solvers</div>
<div class="line">│   ├── ForwardEulerSolver.h                    </div>
<div class="line">│   ├── ImplicitSolver.h                          // Base class for implicit solvers</div>
<div class="line">│   ├── json.hpp                      </div>
<div class="line">│   ├── KnownDerivativeRHS.h                      // RHS with analytically known derivative</div>
<div class="line">│   ├── ModelProblemRHS.h</div>
<div class="line">│   ├── ODERightHandSide.h                        // Base class for RHS functions</div>
<div class="line">│   ├── PolynomialRHS.h</div>
<div class="line">│   ├── RungeKuttaSolver.h                       </div>
<div class="line">│   ├── SolverFactory.h                           </div>
<div class="line">│   └── UnknownDerivativeRHS.h                    // RHS with unknown derivative </div>
<div class="line">├── src/</div>
<div class="line">│   └── [Corresponding .cc files implementing the headers]</div>
<div class="line">├── test/</div>
<div class="line">│   └── [Test files using googletest]</div>
<div class="line">├── .gitignore</div>
<div class="line">├── .gitmodules</div>
<div class="line">├── main.cc     </div>
<div class="line">├── CMakeLists.txt                                </div>
<div class="line">└── README.md                          </div>
</div><!-- fragment --><p>Here is a brief sketch of the class hierarchy.</p>
<p><img src="hierarchy.png" alt="UML Diagram" width="700" class="inline"/></p>
<h1><a class="anchor" id="autotoc_md6"></a>
How to</h1>
<h2><a class="anchor" id="autotoc_md7"></a>
Quick Start</h2>
<p>First, you need to clone the project repository on your local machine. </p><div class="fragment"><div class="line">git clone git@gitlab.epfl.ch:ebaup/pcsc-project.git</div>
<div class="line">cd pcsc-project</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md8"></a>
Set-up and Building</h2>
<p>The project relies on <em>googletest</em> and <em>Eigen</em>, initialize them as submodules to install these dependencies:</p>
<div class="fragment"><div class="line">git submodule update --init </div>
</div><!-- fragment --><p>You can build and run the project using your preferred IDE (e.g., CLion) or the terminal. Below are the steps for the terminal:</p>
<div class="fragment"><div class="line">mkdir build</div>
<div class="line">cd build</div>
<div class="line">cmake ..</div>
<div class="line">make</div>
<div class="line">./main</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md9"></a>
Read the output file</h2>
<div class="fragment"><div class="line">cat output.txt</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md10"></a>
Update the Configuration</h2>
<p>Modify the <code>config/config.json</code> file to set global parameters and solver-specific options. </p><div class="fragment"><div class="line">{</div>
<div class="line">  &quot;global&quot;: {</div>
<div class="line">    &quot;stepSize&quot;: The time step for the solver, e.g., 0.01,</div>
<div class="line">    &quot;t0&quot;: Start time of the simulation, e.g., 0.0,</div>
<div class="line">    &quot;t1&quot;: End time of the simulation, e.g., 1.0,</div>
<div class="line">    &quot;initialValue&quot;: Initial guess y_0, e.g., 1.0</div>
<div class="line">  },</div>
<div class="line">  &quot;solver&quot;: {</div>
<div class="line">    &quot;method&quot;: Solver type, choose from {&quot;RK&quot;, &quot;AB&quot;, &quot;BE&quot;, &quot;FE&quot;},</div>
<div class="line">    &quot;parameters&quot;: {</div>
<div class="line">      &quot;order&quot;: For Runge Kutta, choose from {1, 2, 4},</div>
<div class="line">      &quot;steps&quot;: For AdamsBashforth, choose from {1, 2, 3, 4},</div>
<div class="line">      &quot;initMethod&quot;: For AdamsBashforth, choose from {&quot;RK4&quot;, &quot;FE&quot;},</div>
<div class="line">      &quot;tolerance&quot;: For Newton method in Backward Euler, default 1e-6,</div>
<div class="line">      &quot;maxIter&quot;: For Newton method in Backward Euler, default 50</div>
<div class="line">    }</div>
<div class="line">  },</div>
<div class="line">  &quot;rhs&quot;: {</div>
<div class="line">    &quot;type&quot;: RHS type, choose from {&quot;model&quot;, &quot;poly&quot;},</div>
<div class="line">    &quot;parameters&quot;: {</div>
<div class="line">      &quot;decay&quot;: Decay constant for model problem, e.g., 0.1,</div>
<div class="line">      &quot;coefficients&quot;: For polynomials, a list of coefficients [a_0, a_1, ..., a_n]</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><p><b>Note:</b> It will automatically build the forward Euler method when choosing <code>order = 1</code> for Runge Kutta or <code>steps = 1</code> for AdamsBashforth, as they are the same solvers.</p>
<h2><a class="anchor" id="autotoc_md11"></a>
Documentation</h2>
<p>Building the project also creates a folder 'doc', that contains the doxygen documentation of the project. To see this documentation, there are a few alternatives:</p><ul>
<li>open the file 'index.html' located in doc/html/. This should open a window in your browser with our documentation.</li>
<li>use doxywizard (type <code>doxywizard</code> in your terminal) and select the Doxyfile located in the main folder of the project. Then you can run doxygen from doxywizard to generate the documentation.</li>
</ul>
<h2><a class="anchor" id="autotoc_md12"></a>
Tests</h2>
<p>Another executive file produced by the building concerns the googletests. They are separated in 3 files:</p><ul>
<li><code>auxiliary_test.cc</code>: contains tests on auxiliary classes, mainly on the function class.</li>
<li><code>model_problem_test.cc</code>: contains tests focusing on the model problem. In each execution of this test, a random variable between 0 and 1 is produced, and then all solvers are tested on the model problem defined by this variable.</li>
<li><code>polynomial_test.cc</code>: contains tests on a specific polynomial function, for all solvers.</li>
</ul>
<p>All tests that consist of testing the solvers rely on testing the difference between the actual solution and the approximated one. The tests should pass, also the tolerance threshold for the error is quite high (1e-2). Note that some solvers are also more or less precise, and may require a smaller step size.</p>
<h1><a class="anchor" id="autotoc_md13"></a>
Limitations</h1>
<p>We encountered various challenges during the realisation of this project, some were taken care of, and some remain as limitations of our implementation.</p>
<h2><a class="anchor" id="autotoc_md14"></a>
Solvers classes</h2>
<p>Our first main challenge was to find a suitable class organisation for the different solvers.</p>
<p>A good knowledge of the methods was needed to understand how they relate with each other, and what were their common and specific characteristics. There are different approaches we thought about, and we decided to split the methods between two main categories: <b>explicit</b> and <b>implicit</b>. The explicit methods can be single-step or multi-step methods.</p>
<p>Another approach we thought about was to separate in two other categories: Runge-Kutta and linear multi-step methods. Then linear multi-step methods could have been split between explicit and implicit and would have been determined by their weights.</p>
<h2><a class="anchor" id="autotoc_md15"></a>
Function class</h2>
<p>Our second main challenge was to create a function class, and handle the derivatives. We decided to create a base class (<code>ODERighHandSide</code>) and two children that correspond to functions for which we know the derivative and for which we do not. If the derivative is not known, it is approximated with centered differences.</p>
<p>There are however a few limitations with our approach. First, we can only use the functions that are in the file <code>ExampleRHS.h</code>. An improvement would be to have a parser that lets the user write their function. The user would also need to specify if they want to use the known derivative for the function. This could be done either by letting the user specify the derivative, or by having a derivative calculator accessible in the project.</p>
<h2><a class="anchor" id="autotoc_md16"></a>
Dimension of the ODE</h2>
<p>The main limitation of our project is that it focuses strictly on ODEs that are from $\mathbb{R} \times \mathbb{R}$ to $\mathbb{R}$, i.e. $y,t$ are real and so is $f(t,y)$. Possible extensions could be</p><ul>
<li>allowing $y$ to be a vector, i.e. $y \in \mathbb{R}^n$</li>
<li>allowing $f$ to be a vector-valued function, i.e. solve a system of ODEs</li>
<li>allowing $y$ to be a complex number, or a complex-valued vector, etc.</li>
</ul>
<p>For this a few solutions we thought about were to use template classes and/or Eigen vectors for $y$. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
